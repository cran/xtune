<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jingxuan He and Chubing Zeng" />

<meta name="date" content="2023-06-16" />

<title>Getting started with xtune</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting started with <code>xtune</code></h1>
<h4 class="author">Jingxuan He and Chubing Zeng</h4>
<h4 class="date">2023-06-16</h4>



<div id="purpose-of-this-vignette" class="section level3">
<h3>Purpose of this vignette</h3>
<p>This vignette is a tutorial on how to use the <code>xtune</code> package to fit feature-specific regularized regression models based on external information.</p>
<p>In this tutorial the following points are going to be viewed:</p>
<ul>
<li>The overall idea of <code>xtune</code> model</li>
<li>Three examples of external information Z</li>
<li>How to fit the model</li>
<li>Two special cases of Z</li>
</ul>
</div>
<div id="xtune-overview" class="section level3">
<h3><code>xtune</code> Overview</h3>
<p>The main usage of <code>xtune</code> is to tune multiple shrinkage parameters in regularized regressions (Lasso, Ridge, and Elastic-net), based on external information.</p>
<p>The classical penalized regression uses a single penalty parameter <span class="math inline">\(\lambda\)</span> that applies equally to all regression coefficients to control the amount of regularization in the model. And the single penalty parameter tuning is typically performed using cross-validation.</p>
<p>Here we apply an individual shrinkage parameter <span class="math inline">\(\lambda_j\)</span> to each regression coefficient <span class="math inline">\(\beta_j\)</span>. And the vector of shrinkage parameters <span class="math inline">\(\lambda s = (\lambda_1,...,\lambda_p)\)</span> is guided by external information <span class="math inline">\(Z\)</span>. In specific, <span class="math inline">\(\lambda\)</span>s is modeled as a log-linear function of <span class="math inline">\(Z\)</span>. Better prediction accuracy for penalized regression models may be achieved by allowing individual shrinkage for each regression coefficients based on external information.</p>
<p>To tune the differential shrinkage parameter vector <span class="math inline">\(\lambda s = (\lambda_1,...,\lambda_p)\)</span>, we employ an Empirical Bayes approach by specifying Elastic-net to their random-effect formulation. Once the tuning parameters <span class="math inline">\(\lambda\)</span>s are estimated, and therefore the penalties known, the regression coefficients are obtained using the <code>glmnet</code> package.</p>
<p>The response variable can be either quantitative or categorical. Utilities for carrying out post-fitting summary and prediction are also provided.</p>
</div>
<div id="examples" class="section level3">
<h3>Examples</h3>
<p>Here, we four simulated examples to illustrate the usage and syntax of <code>xtune</code>. The first example gives users a general sense of the data structure and model fitting process. The second and third examples use simulated data in concrete scenarios to illustrate the usage of the package. In the second example <code>diet</code>, we provide simulated data to mimic the dietary example described in this paper:</p>
<p>S. Witte, John &amp; Greenland, Sander &amp; W. Haile, Robert &amp; L. Bird, Cristy. (1994). Hierarchical Regression Analysis Applied to a Study of Multiple Dietary Exposures and Breast Cancer. Epidemiology (Cambridge, Mass.). 5. 612-21. 10.1097/00001648-199411000-00009.</p>
<p>In the third example <code>gene</code>, we provide simulated data to mimic the bone density data published in the European Bioinformatics Institute (EMBL-EBI) ArrayExpress repository, ID: E-MEXP-1618.</p>
<p>And in the fourth example, we simulated data with multicategorical outcomes with three levels to provide the multi-classification example using <code>xtune</code>.</p>
<div id="general-example" class="section level4">
<h4>General Example</h4>
<p>In the first example, <span class="math inline">\(Y\)</span> is a <span class="math inline">\(n = 100\)</span>-dimensional continuous observed outcome vector, <span class="math inline">\(X\)</span> is matrix of <span class="math inline">\(p\)</span> potential predictors observed on the <span class="math inline">\(n\)</span> observations, and <span class="math inline">\(Z\)</span> is a set of <span class="math inline">\(q = 4\)</span> external features available for the <span class="math inline">\(p = 300\)</span> predictors.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(xtune)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">data</span>(<span class="st">&quot;example&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>X &lt;-<span class="st"> </span>example<span class="op">$</span>X; Y &lt;-<span class="st"> </span>example<span class="op">$</span>Y; Z &lt;-<span class="st"> </span>example<span class="op">$</span>Z</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">dim</span>(X);<span class="kw">dim</span>(Z)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; [1] 100 300</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; [1] 300   4</span></span></code></pre></div>
<p>Each column of Z contains information about the predictors in design matrix X. The number of rows in Z equals to the number of predictors in X.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>X[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt;               Predictor_1 Predictor_2 Predictor_3 Predictor_4 Predictor_5</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; Observation_1  -0.7667960   0.9212806   2.0149030  0.79004563  -1.4244699</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; Observation_2  -0.8164583  -0.3144157  -0.2253684  0.08712746  -1.0296026</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; Observation_3  -0.1415352   0.6623149  -1.0398456  1.87611212   0.7340254</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt;               Predictor_6 Predictor_7 Predictor_8 Predictor_9 Predictor_10</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; Observation_1  -0.9529327  -0.9344928 -0.32964818   0.4486023  -0.70894600</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; Observation_2   2.2546851   0.2732793 -0.03852896   1.3830463   0.03070716</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; Observation_3   1.7534320   0.3263808  0.09564893  -2.2104531   0.22615224</span></span></code></pre></div>
<p>The external information is encoded as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>Z[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt;              External_variable_1 External_variable_2 External_variable_3</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; Predictor_1                    1                   0                   0</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; Predictor_2                    1                   0                   0</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; Predictor_3                    0                   1                   0</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; Predictor_4                    0                   1                   0</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; Predictor_5                    0                   0                   1</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; Predictor_6                    0                   0                   1</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; Predictor_7                    0                   0                   0</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; Predictor_8                    0                   0                   0</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; Predictor_9                    0                   0                   0</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; Predictor_10                   0                   0                   0</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt;              External_variable_4</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; Predictor_1                    0</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; Predictor_2                    0</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; Predictor_3                    0</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt; Predictor_4                    0</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt; Predictor_5                    0</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt; Predictor_6                    0</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt; Predictor_7                    1</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; Predictor_8                    1</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; Predictor_9                    1</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; Predictor_10                   1</span></span></code></pre></div>
<p>Here, each variable in Z is a binary variable. <span class="math inline">\(Z_{jk}\)</span> indicates if <span class="math inline">\(Predictor_j\)</span> has <span class="math inline">\(ExternalVariable_k\)</span> or not. This Z is an example of (non-overlapping) grouping of predictors. Predictor 1 and 2 belongs to group 1; predictor 3 and 4 belongs to group 2; predictor 5 and 6 belongs to group 3, and the rest of the predictors belongs to group 4.</p>
<p>To fit a differential-shrinkage lasso model to this data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>fit.example1 &lt;-<span class="st"> </span><span class="kw">xtune</span>(X,Y,Z, <span class="dt">family =</span> <span class="st">&quot;linear&quot;</span>, <span class="dt">c =</span> <span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; Z provided, start estimating individual tuning parameters </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; Start estimating alpha:</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; Done!</span></span></code></pre></div>
<p>Here, we specify the family of the model using the linear response and the LASSO type of penalty by assign <span class="math inline">\(c = 1\)</span>. The individual penalty parameters are returned by</p>
<pre><code>fit.example1$penalty.vector</code></pre>
<p>In this example, predictors in each group get different estimated penalty parameters.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">unique</span>(fit.example1<span class="op">$</span>penalty.vector)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt;                     [,1]</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; Predictor_1 7.861552e-03</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; Predictor_3 1.434484e-02</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; Predictor_5 3.337497e-02</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; Predictor_7 1.804549e+02</span></span></code></pre></div>
<p>Coefficient estimates and predicted values and can be obtained via <code>predict</code> and <code>coef</code>:</p>
<pre><code>coef_xtune(fit.example1)
predict_xtune(fit.example1, newX = X)</code></pre>
<p>The <code>mse</code> function can be used to get the mean square error (MSE) between prediction values and true values.</p>
<pre><code>mse(predict(fit.example1, newX = X), Y)</code></pre>
</div>
<div id="dietary-example" class="section level4">
<h4>Dietary example</h4>
<p>Suppose we want to predict a personâ€™s weight loss (binary outcome) using his/her weekly dietary intake. Our external information Z could incorporate information about the levels of relevant food constituents in the dietary items.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">data</span>(diet)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">head</span>(diet<span class="op">$</span>DietItems)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;      Milk Margarine Eggs Apples Lettuce Celery Hot dogs Liver Dark bread Pasta</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; [1,]    1         1    4      1       2      1        1     0          0     1</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; [2,]    1         0    0      0       2      4        0     0          2     0</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; [3,]    0         1    2      3       1      3        0     0          4     0</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; [4,]    0         2    0      1       0      1        1     0          3     1</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; [5,]    0         1    1      3       1      1        0     2          2     2</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; [6,]    2         1    2      1       3      0        1     2          2     1</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt;      Beer Liquor Cookies Bran</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; [1,]    0      2       3    4</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; [2,]    2      1       0    3</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; [3,]    1      2       1    1</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; [4,]    1      1       1    2</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; [5,]    0      0       0    3</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; [6,]    1      0       2    1</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="kw">head</span>(diet<span class="op">$</span>weightloss)</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; [1] 0 1 1 1 1 1</span></span></code></pre></div>
<p>The external information Z in this example is:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">head</span>(diet<span class="op">$</span>NuitritionFact)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>In this example, Z is not a grouping of the predictors. The idea is that the nutrition facts about the dietary items might give us some information on the importance of each predictor in the model.</p>
<p>Similar to the previous example, the xtune model could be fit by:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>fit.diet =<span class="st"> </span><span class="kw">xtune</span>(<span class="dt">X =</span> diet<span class="op">$</span>DietItems,<span class="dt">Y=</span>diet<span class="op">$</span>weightloss,<span class="dt">Z =</span> diet<span class="op">$</span>NuitritionFact, <span class="dt">family=</span><span class="st">&quot;binary&quot;</span>, <span class="dt">c =</span> <span class="dv">0</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; No Z matrix provided, only a single tuning parameter will be estimated using empirical Bayes tuning </span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; Start estimating alpha:</span></span></code></pre></div>
<p>Here, we use the Ridge model by specifying <span class="math inline">\(c = 0\)</span>. Each dietary predictor is estimated an individual tuning parameter based on their nutrition fact.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>fit.diet<span class="op">$</span>penalty.vector</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre></div>
<p>To make prediction using the trained model</p>
<pre><code>predict_xtune(fit.diet,newX = diet$DietItems)</code></pre>
<p>The above code returns the predicted probabilities (scores). To make a class prediction, use the <code>type = &quot;class&quot;</code> option.</p>
<pre><code>pred_class &lt;- predict_xtune(fit.diet,newX = diet$DietItems,type = &quot;class&quot;)</code></pre>
<p>The <code>misclassification()</code> function can be used to extract the misclassification rate. The prediction AUC can be calculated using the auc() function from the AUC package.</p>
<pre><code>misclassification(pred_class,true = diet$weightloss)</code></pre>
</div>
<div id="gene-expression-data-example" class="section level4">
<h4>Gene expression data example</h4>
<p>The <code>gene</code> data contains simulated gene expression data. The dimension of data is <span class="math inline">\(50\times 200\)</span>. The outcome Y is continuous (bone mineral density). The external information is four previous study results that identify the biological importance of genes. For example <span class="math inline">\(Z_{jk}\)</span> means whether <span class="math inline">\(gene_j\)</span> is identified to be biologically important in previous study <span class="math inline">\(k\)</span> result. <span class="math inline">\(Z_{jk} = 1\)</span> means that gene <span class="math inline">\(j\)</span> is identified by previous study <span class="math inline">\(k\)</span> result and <span class="math inline">\(Z_{jk} = 0\)</span> means that gene <span class="math inline">\(j\)</span> is not identified to be important by previous study <span class="math inline">\(k\)</span> result.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">data</span>(gene)</span>
<span id="cb16-2"><a href="#cb16-2"></a>gene<span class="op">$</span>GeneExpression[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt;          Gene_1     Gene_2     Gene_3     Gene_4     Gene_5</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; [1,] -0.7667960  1.7520578  0.9212806 -0.6273008  2.0149030</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; [2,] -0.8164583 -0.5477714 -0.3144157 -0.8796116 -0.2253684</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; [3,] -0.1415352 -0.8585257  0.6623149 -0.3053110 -1.0398456</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>gene<span class="op">$</span>PreviousStudy[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt;        Identified by previous study 1 Identified by previous study 2</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; Gene_1                              0                              0</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; Gene_2                              0                              0</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt; Gene_3                              0                              0</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt; Gene_4                              0                              0</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt; Gene_5                              0                              0</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#&gt;        Identified by previous study 3 Identified by previous study 4</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt; Gene_1                              0                              0</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt; Gene_2                              0                              0</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#&gt; Gene_3                              0                              0</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">#&gt; Gene_4                              0                              0</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">#&gt; Gene_5                              0                              0</span></span></code></pre></div>
<p>A gene can be identified to be important by several previous study results, therefore the external information Z in this example can be seen as an overlapping group of variables.</p>
<p>Model fitting:</p>
<pre><code>fit.gene = xtune(X = gene$GeneExpression,Y=gene$bonedensity,Z = gene$PreviousStudy, family  = &quot;linear&quot;, c = 0.5)</code></pre>
<p>We use the Elastic-net model by specifying <span class="math inline">\(c = 0.5\)</span> (can be any numerical value from 0 to 1). The rest of the steps are the same as the previous two examples.</p>
</div>
<div id="multi-classification-data-example" class="section level4">
<h4>Multi-classification data example</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">data</span>(<span class="st">&quot;example.multiclass&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">dim</span>(example.multiclass<span class="op">$</span>X); <span class="kw">dim</span>(example.multiclass<span class="op">$</span>Y); <span class="kw">dim</span>(example.multiclass<span class="op">$</span>Z)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; [1] 600 800</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; [1] 600   1</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt; [1] 800   5</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="kw">head</span>(example.multiclass<span class="op">$</span>X)[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt;            [,1]        [,2]       [,3]        [,4]       [,5]</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt; [1,]  0.7445670  1.47901632 -0.1556682 -0.64053491 -1.2694581</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; [2,]  0.2170827  0.08309395  0.8571237 -0.12263159  0.4443480</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; [3,]  0.7843483  2.07273526  0.5046653 -0.56627993 -0.3385034</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; [4,]  0.4509514 -0.34583708 -0.5824597 -0.71907762 -0.5209697</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt; [5,]  1.2444328  2.14042805  0.4639056 -0.01205312  1.2121137</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt; [6,] -1.2819254 -0.83835437  0.6999223  0.04828028  1.0246388</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="kw">head</span>(example.multiclass<span class="op">$</span>Y)</span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt;      [,1]</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; [1,]    3</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt; [2,]    2</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">#&gt; [3,]    1</span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">#&gt; [4,]    2</span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="co">#&gt; [5,]    3</span></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co">#&gt; [6,]    2</span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="kw">head</span>(example.multiclass<span class="op">$</span>Z)</span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="co">#&gt; [2,]    0    0    0    0    1</span></span>
<span id="cb18-26"><a href="#cb18-26"></a><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="co">#&gt; [4,]    0    0    0    0    0</span></span>
<span id="cb18-28"><a href="#cb18-28"></a><span class="co">#&gt; [5,]    0    0    0    1    0</span></span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="co">#&gt; [6,]    0    0    0    0    0</span></span></code></pre></div>
<p>Model fitting:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>fit.multiclass =<span class="st"> </span><span class="kw">xtune</span>(<span class="dt">X =</span> example.multiclass<span class="op">$</span>X,<span class="dt">Y=</span>example.multiclass<span class="op">$</span>Y,<span class="dt">Z =</span> example.multiclass<span class="op">$</span>Z, <span class="dt">U =</span> example.multiclass<span class="op">$</span>U, <span class="dt">family  =</span> <span class="st">&quot;multiclass&quot;</span>, <span class="dt">c =</span> <span class="fl">0.5</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#&gt; Z provided, start estimating individual tuning parameters </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; Start estimating alpha:</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; Done!</span></span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># check the tuning parameter</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>fit.multiclass<span class="op">$</span>penalty.vector</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#&gt;   [1] 0.019033238 0.020019923 0.019033238 0.019033238 0.019070537 0.019033238</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#&gt;   [7] 0.019406624 0.019033238 0.016390346 0.019033238 0.019406624 0.020019923</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">#&gt;  [13] 0.015582545 0.019033238 0.020019923 0.019033238 0.011414296 0.019033238</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#&gt;  [19] 0.011414296 0.020019923 0.011414296 0.019033238 0.015582545 0.019033238</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">#&gt;  [25] 0.019033238 0.015582545 0.019033238 0.020019923 0.019033238 0.019033238</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">#&gt;  [31] 0.015582545 0.019033238 0.019033238 0.011414296 0.019033238 0.019406624</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">#&gt;  [37] 0.019033238 0.019033238 0.019033238 0.019033238 0.019406624 0.012006014</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#&gt;  [43] 0.015582545 0.015582545 0.019033238 0.019406624 0.019033238 0.019033238</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#&gt;  [49] 0.015582545 0.019033238 0.020019923 0.019033238 0.015582545 0.019033238</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#&gt;  [55] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.011414296</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#&gt;  [61] 0.019033238 0.011414296 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt;  [67] 0.019033238 0.015582545 0.019033238 0.016390346 0.019070537 0.019033238</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#&gt;  [73] 0.019033238 0.011414296 0.019033238 0.020412666 0.019033238 0.019033238</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt;  [79] 0.011414296 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt;  [85] 0.019406624 0.019033238 0.019033238 0.011414296 0.015582545 0.019033238</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#&gt;  [91] 0.011414296 0.019033238 0.019033238 0.019033238 0.011414296 0.020059155</span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">#&gt;  [97] 0.019033238 0.019033238 0.020019923 0.019033238 0.015582545 0.019033238</span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co">#&gt; [103] 0.015888237 0.019033238 0.019070537 0.019033238 0.019406624 0.019033238</span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co">#&gt; [109] 0.019033238 0.020019923 0.019070537 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co">#&gt; [115] 0.019033238 0.015582545 0.015582545 0.020019923 0.019033238 0.019406624</span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co">#&gt; [121] 0.015582545 0.019033238 0.011414296 0.019070537 0.019033238 0.019033238</span></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co">#&gt; [127] 0.019033238 0.015582545 0.019033238 0.019033238 0.020019923 0.019033238</span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co">#&gt; [133] 0.019033238 0.019033238 0.019070537 0.019033238 0.019444655 0.019033238</span></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co">#&gt; [139] 0.011414296 0.019033238 0.019033238 0.011414296 0.019033238 0.019033238</span></span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co">#&gt; [145] 0.020019923 0.011414296 0.009344904 0.011414296 0.019033238 0.019033238</span></span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="co">#&gt; [151] 0.019033238 0.019033238 0.019033238 0.019033238 0.019406624 0.019033238</span></span>
<span id="cb19-34"><a href="#cb19-34"></a><span class="co">#&gt; [157] 0.019033238 0.015582545 0.020019923 0.019406624 0.019033238 0.019033238</span></span>
<span id="cb19-35"><a href="#cb19-35"></a><span class="co">#&gt; [163] 0.019406624 0.019033238 0.019070537 0.019033238 0.020019923 0.019406624</span></span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="co">#&gt; [169] 0.019070537 0.019070537 0.019033238 0.019070537 0.019406624 0.019033238</span></span>
<span id="cb19-37"><a href="#cb19-37"></a><span class="co">#&gt; [175] 0.019033238 0.019033238 0.019033238 0.019070537 0.019070537 0.019033238</span></span>
<span id="cb19-38"><a href="#cb19-38"></a><span class="co">#&gt; [181] 0.011414296 0.019033238 0.019033238 0.015582545 0.016390346 0.019033238</span></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="co">#&gt; [187] 0.015582545 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-40"><a href="#cb19-40"></a><span class="co">#&gt; [193] 0.019406624 0.019033238 0.009528229 0.019033238 0.019070537 0.019033238</span></span>
<span id="cb19-41"><a href="#cb19-41"></a><span class="co">#&gt; [199] 0.019070537 0.019033238 0.019033238 0.011414296 0.019070537 0.011414296</span></span>
<span id="cb19-42"><a href="#cb19-42"></a><span class="co">#&gt; [205] 0.019033238 0.015582545 0.011414296 0.019033238 0.011414296 0.015582545</span></span>
<span id="cb19-43"><a href="#cb19-43"></a><span class="co">#&gt; [211] 0.019033238 0.019444655 0.015613082 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-44"><a href="#cb19-44"></a><span class="co">#&gt; [217] 0.019033238 0.015582545 0.015582545 0.015582545 0.020019923 0.019033238</span></span>
<span id="cb19-45"><a href="#cb19-45"></a><span class="co">#&gt; [223] 0.015582545 0.011414296 0.016390346 0.019033238 0.019033238 0.020019923</span></span>
<span id="cb19-46"><a href="#cb19-46"></a><span class="co">#&gt; [229] 0.019033238 0.020412666 0.019033238 0.019070537 0.019033238 0.015582545</span></span>
<span id="cb19-47"><a href="#cb19-47"></a><span class="co">#&gt; [235] 0.020019923 0.019033238 0.019033238 0.015582545 0.019070537 0.019033238</span></span>
<span id="cb19-48"><a href="#cb19-48"></a><span class="co">#&gt; [241] 0.019033238 0.019033238 0.019033238 0.019033238 0.019406624 0.015582545</span></span>
<span id="cb19-49"><a href="#cb19-49"></a><span class="co">#&gt; [247] 0.019033238 0.019033238 0.019033238 0.015582545 0.019033238 0.019070537</span></span>
<span id="cb19-50"><a href="#cb19-50"></a><span class="co">#&gt; [253] 0.016390346 0.020019923 0.020019923 0.015582545 0.011414296 0.016390346</span></span>
<span id="cb19-51"><a href="#cb19-51"></a><span class="co">#&gt; [259] 0.019033238 0.015888237 0.019033238 0.019070537 0.019033238 0.019070537</span></span>
<span id="cb19-52"><a href="#cb19-52"></a><span class="co">#&gt; [265] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.020019923</span></span>
<span id="cb19-53"><a href="#cb19-53"></a><span class="co">#&gt; [271] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-54"><a href="#cb19-54"></a><span class="co">#&gt; [277] 0.019070537 0.020019923 0.019033238 0.019070537 0.019070537 0.019033238</span></span>
<span id="cb19-55"><a href="#cb19-55"></a><span class="co">#&gt; [283] 0.020412666 0.019033238 0.012006014 0.019406624 0.015888237 0.011414296</span></span>
<span id="cb19-56"><a href="#cb19-56"></a><span class="co">#&gt; [289] 0.019033238 0.019033238 0.011414296 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-57"><a href="#cb19-57"></a><span class="co">#&gt; [295] 0.019033238 0.019033238 0.015582545 0.019033238 0.012006014 0.019033238</span></span>
<span id="cb19-58"><a href="#cb19-58"></a><span class="co">#&gt; [301] 0.019033238 0.011414296 0.019033238 0.019033238 0.020412666 0.015582545</span></span>
<span id="cb19-59"><a href="#cb19-59"></a><span class="co">#&gt; [307] 0.019033238 0.015582545 0.019033238 0.015582545 0.019033238 0.020019923</span></span>
<span id="cb19-60"><a href="#cb19-60"></a><span class="co">#&gt; [313] 0.015582545 0.019033238 0.019070537 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-61"><a href="#cb19-61"></a><span class="co">#&gt; [319] 0.020019923 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-62"><a href="#cb19-62"></a><span class="co">#&gt; [325] 0.020019923 0.019033238 0.019033238 0.011414296 0.019033238 0.019033238</span></span>
<span id="cb19-63"><a href="#cb19-63"></a><span class="co">#&gt; [331] 0.019033238 0.019406624 0.019033238 0.020019923 0.019033238 0.019033238</span></span>
<span id="cb19-64"><a href="#cb19-64"></a><span class="co">#&gt; [337] 0.020019923 0.015582545 0.019070537 0.019033238 0.019033238 0.015582545</span></span>
<span id="cb19-65"><a href="#cb19-65"></a><span class="co">#&gt; [343] 0.011414296 0.019406624 0.011414296 0.011414296 0.019406624 0.011414296</span></span>
<span id="cb19-66"><a href="#cb19-66"></a><span class="co">#&gt; [349] 0.015582545 0.019033238 0.019406624 0.019033238 0.019033238 0.020019923</span></span>
<span id="cb19-67"><a href="#cb19-67"></a><span class="co">#&gt; [355] 0.019444655 0.019070537 0.019033238 0.019033238 0.019033238 0.016390346</span></span>
<span id="cb19-68"><a href="#cb19-68"></a><span class="co">#&gt; [361] 0.019033238 0.015582545 0.019033238 0.019033238 0.011638217 0.009344904</span></span>
<span id="cb19-69"><a href="#cb19-69"></a><span class="co">#&gt; [367] 0.020019923 0.019033238 0.019033238 0.019033238 0.019070537 0.019033238</span></span>
<span id="cb19-70"><a href="#cb19-70"></a><span class="co">#&gt; [373] 0.009363217 0.019033238 0.019070537 0.019033238 0.019070537 0.019033238</span></span>
<span id="cb19-71"><a href="#cb19-71"></a><span class="co">#&gt; [379] 0.019070537 0.015582545 0.019033238 0.020019923 0.019033238 0.019033238</span></span>
<span id="cb19-72"><a href="#cb19-72"></a><span class="co">#&gt; [385] 0.015582545 0.019033238 0.019033238 0.016390346 0.019033238 0.011414296</span></span>
<span id="cb19-73"><a href="#cb19-73"></a><span class="co">#&gt; [391] 0.011414296 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-74"><a href="#cb19-74"></a><span class="co">#&gt; [397] 0.019033238 0.015582545 0.019033238 0.020019923 0.015582545 0.019033238</span></span>
<span id="cb19-75"><a href="#cb19-75"></a><span class="co">#&gt; [403] 0.019033238 0.019033238 0.015582545 0.011414296 0.019070537 0.020019923</span></span>
<span id="cb19-76"><a href="#cb19-76"></a><span class="co">#&gt; [409] 0.019033238 0.019033238 0.019070537 0.020059155 0.019033238 0.019070537</span></span>
<span id="cb19-77"><a href="#cb19-77"></a><span class="co">#&gt; [415] 0.011436664 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-78"><a href="#cb19-78"></a><span class="co">#&gt; [421] 0.011414296 0.019033238 0.019033238 0.019033238 0.019033238 0.015613082</span></span>
<span id="cb19-79"><a href="#cb19-79"></a><span class="co">#&gt; [427] 0.015582545 0.019033238 0.019406624 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-80"><a href="#cb19-80"></a><span class="co">#&gt; [433] 0.019033238 0.020059155 0.019070537 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-81"><a href="#cb19-81"></a><span class="co">#&gt; [439] 0.019406624 0.011414296 0.015888237 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-82"><a href="#cb19-82"></a><span class="co">#&gt; [445] 0.011414296 0.019033238 0.020019923 0.019033238 0.020019923 0.015582545</span></span>
<span id="cb19-83"><a href="#cb19-83"></a><span class="co">#&gt; [451] 0.020059155 0.019033238 0.019033238 0.019033238 0.019033238 0.011414296</span></span>
<span id="cb19-84"><a href="#cb19-84"></a><span class="co">#&gt; [457] 0.019070537 0.019033238 0.019033238 0.020412666 0.019070537 0.015582545</span></span>
<span id="cb19-85"><a href="#cb19-85"></a><span class="co">#&gt; [463] 0.019033238 0.019070537 0.019033238 0.019033238 0.015582545 0.019033238</span></span>
<span id="cb19-86"><a href="#cb19-86"></a><span class="co">#&gt; [469] 0.019070537 0.019070537 0.019033238 0.019406624 0.019033238 0.019033238</span></span>
<span id="cb19-87"><a href="#cb19-87"></a><span class="co">#&gt; [475] 0.019033238 0.019406624 0.019033238 0.019033238 0.019033238 0.019070537</span></span>
<span id="cb19-88"><a href="#cb19-88"></a><span class="co">#&gt; [481] 0.019033238 0.019033238 0.019033238 0.015582545 0.020019923 0.019033238</span></span>
<span id="cb19-89"><a href="#cb19-89"></a><span class="co">#&gt; [487] 0.019033238 0.019033238 0.019033238 0.019406624 0.019406624 0.019033238</span></span>
<span id="cb19-90"><a href="#cb19-90"></a><span class="co">#&gt; [493] 0.015582545 0.011414296 0.019033238 0.019033238 0.011414296 0.019033238</span></span>
<span id="cb19-91"><a href="#cb19-91"></a><span class="co">#&gt; [499] 0.016390346 0.019033238 0.019070537 0.019406624 0.015582545 0.019033238</span></span>
<span id="cb19-92"><a href="#cb19-92"></a><span class="co">#&gt; [505] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.015582545</span></span>
<span id="cb19-93"><a href="#cb19-93"></a><span class="co">#&gt; [511] 0.011414296 0.019033238 0.011414296 0.011414296 0.019033238 0.019070537</span></span>
<span id="cb19-94"><a href="#cb19-94"></a><span class="co">#&gt; [517] 0.019070537 0.019033238 0.019033238 0.020019923 0.020019923 0.019033238</span></span>
<span id="cb19-95"><a href="#cb19-95"></a><span class="co">#&gt; [523] 0.019033238 0.019070537 0.019033238 0.019406624 0.019033238 0.020019923</span></span>
<span id="cb19-96"><a href="#cb19-96"></a><span class="co">#&gt; [529] 0.015582545 0.019406624 0.019033238 0.016390346 0.019033238 0.019033238</span></span>
<span id="cb19-97"><a href="#cb19-97"></a><span class="co">#&gt; [535] 0.019033238 0.011414296 0.020019923 0.015582545 0.019033238 0.019033238</span></span>
<span id="cb19-98"><a href="#cb19-98"></a><span class="co">#&gt; [541] 0.009528229 0.019033238 0.019033238 0.019406624 0.019070537 0.019033238</span></span>
<span id="cb19-99"><a href="#cb19-99"></a><span class="co">#&gt; [547] 0.019033238 0.020019923 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-100"><a href="#cb19-100"></a><span class="co">#&gt; [553] 0.019033238 0.019033238 0.019033238 0.019033238 0.019070537 0.019033238</span></span>
<span id="cb19-101"><a href="#cb19-101"></a><span class="co">#&gt; [559] 0.015582545 0.015582545 0.019033238 0.019033238 0.011414296 0.019033238</span></span>
<span id="cb19-102"><a href="#cb19-102"></a><span class="co">#&gt; [565] 0.019033238 0.012006014 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-103"><a href="#cb19-103"></a><span class="co">#&gt; [571] 0.019444655 0.019033238 0.019033238 0.019033238 0.019406624 0.019070537</span></span>
<span id="cb19-104"><a href="#cb19-104"></a><span class="co">#&gt; [577] 0.019033238 0.011414296 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-105"><a href="#cb19-105"></a><span class="co">#&gt; [583] 0.015582545 0.019033238 0.019033238 0.019444655 0.019033238 0.019033238</span></span>
<span id="cb19-106"><a href="#cb19-106"></a><span class="co">#&gt; [589] 0.020019923 0.019406624 0.019406624 0.020019923 0.019033238 0.019033238</span></span>
<span id="cb19-107"><a href="#cb19-107"></a><span class="co">#&gt; [595] 0.019033238 0.009344904 0.019444655 0.011414296 0.019070537 0.019033238</span></span>
<span id="cb19-108"><a href="#cb19-108"></a><span class="co">#&gt; [601] 0.019033238 0.015582545 0.019033238 0.019033238 0.019406624 0.016422466</span></span>
<span id="cb19-109"><a href="#cb19-109"></a><span class="co">#&gt; [607] 0.019033238 0.019033238 0.019033238 0.020412666 0.009344904 0.019444655</span></span>
<span id="cb19-110"><a href="#cb19-110"></a><span class="co">#&gt; [613] 0.015582545 0.019033238 0.015582545 0.019033238 0.019406624 0.019033238</span></span>
<span id="cb19-111"><a href="#cb19-111"></a><span class="co">#&gt; [619] 0.019033238 0.019406624 0.019033238 0.019033238 0.019033238 0.015582545</span></span>
<span id="cb19-112"><a href="#cb19-112"></a><span class="co">#&gt; [625] 0.019033238 0.019406624 0.020019923 0.019033238 0.019033238 0.015888237</span></span>
<span id="cb19-113"><a href="#cb19-113"></a><span class="co">#&gt; [631] 0.019033238 0.019033238 0.019033238 0.020019923 0.019033238 0.019033238</span></span>
<span id="cb19-114"><a href="#cb19-114"></a><span class="co">#&gt; [637] 0.020019923 0.019033238 0.019033238 0.019070537 0.011414296 0.019033238</span></span>
<span id="cb19-115"><a href="#cb19-115"></a><span class="co">#&gt; [643] 0.019070537 0.019033238 0.019406624 0.019070537 0.019033238 0.019406624</span></span>
<span id="cb19-116"><a href="#cb19-116"></a><span class="co">#&gt; [649] 0.012006014 0.019033238 0.019033238 0.019033238 0.011414296 0.019033238</span></span>
<span id="cb19-117"><a href="#cb19-117"></a><span class="co">#&gt; [655] 0.019070537 0.019033238 0.019070537 0.019070537 0.019033238 0.019033238</span></span>
<span id="cb19-118"><a href="#cb19-118"></a><span class="co">#&gt; [661] 0.019033238 0.019033238 0.019033238 0.019033238 0.019070537 0.019033238</span></span>
<span id="cb19-119"><a href="#cb19-119"></a><span class="co">#&gt; [667] 0.019444655 0.019033238 0.015888237 0.019033238 0.020019923 0.011414296</span></span>
<span id="cb19-120"><a href="#cb19-120"></a><span class="co">#&gt; [673] 0.019406624 0.019033238 0.019033238 0.019033238 0.019033238 0.019406624</span></span>
<span id="cb19-121"><a href="#cb19-121"></a><span class="co">#&gt; [679] 0.020019923 0.019033238 0.015582545 0.015582545 0.019070537 0.019033238</span></span>
<span id="cb19-122"><a href="#cb19-122"></a><span class="co">#&gt; [685] 0.019033238 0.019033238 0.019406624 0.019406624 0.019033238 0.009528229</span></span>
<span id="cb19-123"><a href="#cb19-123"></a><span class="co">#&gt; [691] 0.019033238 0.019070537 0.015582545 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-124"><a href="#cb19-124"></a><span class="co">#&gt; [697] 0.019033238 0.019033238 0.019033238 0.015582545 0.020019923 0.015582545</span></span>
<span id="cb19-125"><a href="#cb19-125"></a><span class="co">#&gt; [703] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-126"><a href="#cb19-126"></a><span class="co">#&gt; [709] 0.019033238 0.020019923 0.019444655 0.012006014 0.019406624 0.019033238</span></span>
<span id="cb19-127"><a href="#cb19-127"></a><span class="co">#&gt; [715] 0.019033238 0.015582545 0.015582545 0.020019923 0.019033238 0.019033238</span></span>
<span id="cb19-128"><a href="#cb19-128"></a><span class="co">#&gt; [721] 0.015582545 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-129"><a href="#cb19-129"></a><span class="co">#&gt; [727] 0.019406624 0.019406624 0.019033238 0.019033238 0.019033238 0.020019923</span></span>
<span id="cb19-130"><a href="#cb19-130"></a><span class="co">#&gt; [733] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.011414296</span></span>
<span id="cb19-131"><a href="#cb19-131"></a><span class="co">#&gt; [739] 0.019033238 0.019033238 0.019033238 0.019070537 0.019070537 0.020019923</span></span>
<span id="cb19-132"><a href="#cb19-132"></a><span class="co">#&gt; [745] 0.015888237 0.011436664 0.019033238 0.019033238 0.015582545 0.012006014</span></span>
<span id="cb19-133"><a href="#cb19-133"></a><span class="co">#&gt; [751] 0.020019923 0.019033238 0.019033238 0.019070537 0.019033238 0.020019923</span></span>
<span id="cb19-134"><a href="#cb19-134"></a><span class="co">#&gt; [757] 0.015582545 0.020019923 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-135"><a href="#cb19-135"></a><span class="co">#&gt; [763] 0.019406624 0.019033238 0.015888237 0.019070537 0.019033238 0.015582545</span></span>
<span id="cb19-136"><a href="#cb19-136"></a><span class="co">#&gt; [769] 0.019033238 0.019033238 0.019033238 0.019033238 0.019070537 0.015582545</span></span>
<span id="cb19-137"><a href="#cb19-137"></a><span class="co">#&gt; [775] 0.019033238 0.011414296 0.019406624 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-138"><a href="#cb19-138"></a><span class="co">#&gt; [781] 0.019033238 0.019406624 0.019033238 0.019033238 0.019033238 0.019033238</span></span>
<span id="cb19-139"><a href="#cb19-139"></a><span class="co">#&gt; [787] 0.019033238 0.019033238 0.019033238 0.019033238 0.019033238 0.020452668</span></span>
<span id="cb19-140"><a href="#cb19-140"></a><span class="co">#&gt; [793] 0.019033238 0.019033238 0.019033238 0.019033238 0.020019923 0.015582545</span></span>
<span id="cb19-141"><a href="#cb19-141"></a><span class="co">#&gt; [799] 0.019033238 0.019406624 0.000000000 0.000000000 0.000000000 0.000000000</span></span>
<span id="cb19-142"><a href="#cb19-142"></a><span class="co">#&gt; [805] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000</span></span></code></pre></div>
<p>To make prediction using the trained model:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>pred.prob =<span class="st"> </span><span class="kw">predict_xtune</span>(fit.multiclass,<span class="dt">newX =</span> <span class="kw">cbind</span>(example.multiclass<span class="op">$</span>X, example.multiclass<span class="op">$</span>U))</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">head</span>(pred.prob)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt;           1.1        2.1        3.1</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt; 1 0.152714695 0.04651872 0.80076659</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt; 2 0.001784845 0.96370971 0.03450544</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; 3 0.594903813 0.14663364 0.25846255</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; 4 0.040101522 0.84879438 0.11110409</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; 5 0.084372394 0.17279569 0.74283192</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; 6 0.012523512 0.89878034 0.08869615</span></span></code></pre></div>
<p>The above code returns the predicted probabilities (scores) for each class. To make a class prediction, specify the argument <code>type = &quot;class&quot;</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>pred.class &lt;-<span class="st"> </span><span class="kw">predict_xtune</span>(fit.multiclass,<span class="dt">newX =</span> <span class="kw">cbind</span>(example.multiclass<span class="op">$</span>X, example.multiclass<span class="op">$</span>U), <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">head</span>(pred.class)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#&gt; [1] &quot;3&quot; &quot;2&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;2&quot;</span></span></code></pre></div>
<p>The <code>misclassification()</code> function can be used to extract the misclassification rate. The multiclass AUC can be calculated using the <code>multiclass.roc</code> function from the <code>pROC</code> package.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">misclassification</span>(pred.class,<span class="dt">true =</span> example.multiclass<span class="op">$</span>Y)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt; [1] 0.006666667</span></span></code></pre></div>
</div>
</div>
<div id="two-special-cases" class="section level3">
<h3>Two special cases</h3>
<div id="no-external-information-z" class="section level4">
<h4>No external information Z</h4>
<p>If you just want to tune a single penalty parameter using empirical Bayes tuning, simply do not provide Z in the <code>xtune()</code> function. If no external information Z is provided, the function will perform empirical Bayes tuning to choose the single penalty parameter in penalized regression, as an alternative to cross-validation. For example</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>fit.eb &lt;-<span class="st"> </span><span class="kw">xtune</span>(X,Y, <span class="dt">family =</span> <span class="st">&quot;linear&quot;</span>, <span class="dt">c =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; No Z matrix provided, only a single tuning parameter will be estimated using empirical Bayes tuning </span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt; Start estimating alpha:</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; Done!</span></span></code></pre></div>
<p>The estimated tuning parameter is:</p>
<pre><code>fit.eb$lambda</code></pre>
</div>
<div id="z-as-an-identity-matrix" class="section level4">
<h4>Z as an identity matrix</h4>
<p>If you provide an identity matrix as external information Z to <code>xtune()</code>, the function will estimate a separate tuning parameter <span class="math inline">\(\lambda_j\)</span> for each regression coefficient <span class="math inline">\(\beta_j\)</span>. Note that this is not advised when the number of predictors <span class="math inline">\(p\)</span> is very large.</p>
<p>Using the dietary example, the following code would estimate a separate penalty parameter for each coefficient.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a></span>
<span id="cb25-2"><a href="#cb25-2"></a>Z_iden =<span class="st"> </span><span class="kw">diag</span>(<span class="kw">ncol</span>(diet<span class="op">$</span>DietItems))</span>
<span id="cb25-3"><a href="#cb25-3"></a>fit.diet.identity =<span class="st"> </span><span class="kw">xtune</span>(diet<span class="op">$</span>DietItems,diet<span class="op">$</span>weightloss,Z_iden, <span class="dt">family =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">c =</span> <span class="fl">0.5</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">#&gt; Z provided, start estimating individual tuning parameters </span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; Start estimating alpha:</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>fit.diet.identity<span class="op">$</span>penalty.vector</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#&gt;               [,1]</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#&gt;  [1,] 1.619150e+02</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt;  [2,] 2.667150e+02</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt;  [3,] 8.667794e-02</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt;  [4,] 1.160597e-02</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt;  [5,] 1.514302e+02</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt;  [6,] 2.667643e+02</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt;  [7,] 2.585258e+02</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#&gt;  [8,] 1.315713e-01</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#&gt;  [9,] 2.784969e-03</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#&gt; [10,] 4.277238e+02</span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#&gt; [11,] 5.663159e+02</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#&gt; [12,] 2.438229e+02</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; [13,] 1.000000e+03</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#&gt; [14,] 6.516246e+02</span></span></code></pre></div>
<p>A predictor is excluded from the model (regression coefficient equals to zero) if its corresponding penalty parameter is estimated to be infinity.</p>
</div>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>We presented the main usage of <code>xtune</code> package. For more details about each function, please go check the package documentation. If you would like to give us feedback or report issue, please tell us on <a href="https://github.com/JingxuanH/xtune">Github</a>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
